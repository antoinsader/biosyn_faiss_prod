
======================================================================
▶ EVENT LOG :: [TRAIN] :: [Faiss recall] :: epoch= 4

----------------------------------------------------------------------
                Message     : faiss recall@40: 0.7888. faiss recall@5: 0.7487

----------------------------------------------------------------------
■ EVENT LOG END :: Faiss recall
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [Epoch summary] :: epoch= 4

----------------------------------------------------------------------
                Message     : Epoch average loss=0.239, average margin=0.3463, average mrr=0.7824, average accuracy@5=0.7928.   loss_temp=0.060

                Event elapsed time: 2227.01 seconds
                CPU Memory  : 5531.1 MB
                GPU MEMORY STATS: free/total = 192.8/24091.8MB - allocated/peak allocated = 943.6/14645.2MB - reserved/peak reserved = 21650.0/21650.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: Epoch summary
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [FAISS BUILD] :: epoch= 5

----------------------------------------------------------------------
                Message     : FAISS built from dictionary embs

                Event elapsed time: 800.36 seconds
                CPU Memory  : 5480.9 MB
                GPU MEMORY STATS: free/total = 16082.8/24091.8MB - allocated/peak allocated = 943.4/14489.5MB - reserved/peak reserved = 5766.0/21588.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: FAISS BUILD
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [FAISS SEARCH]

----------------------------------------------------------------------
                Message     : FAISS searched the candidates and resulted candidates_idxs with shape=(159591, 40)

                Event elapsed time: 236.41 seconds
                CPU Memory  : 5540.0 MB
                GPU MEMORY STATS: free/total = 260.8/24091.8MB - allocated/peak allocated = 943.4/14493.8MB - reserved/peak reserved = 21588.0/21588.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: FAISS SEARCH
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [Faiss recall] :: epoch= 5

----------------------------------------------------------------------
                Message     : faiss recall@40: 0.7971. faiss recall@5: 0.7679

----------------------------------------------------------------------
■ EVENT LOG END :: Faiss recall
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [Epoch summary] :: epoch= 5

----------------------------------------------------------------------
                Message     : Epoch average loss=0.166, average margin=0.3731, average mrr=0.7870, average accuracy@5=0.8059.   loss_temp=0.060

                Event elapsed time: 2332.06 seconds
                CPU Memory  : 5533.0 MB
                GPU MEMORY STATS: free/total = 198.8/24091.8MB - allocated/peak allocated = 943.6/14645.2MB - reserved/peak reserved = 21650.0/21650.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: Epoch summary
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [FAISS BUILD] :: epoch= 6

----------------------------------------------------------------------
                Message     : FAISS built from dictionary embs

                Event elapsed time: 799.57 seconds
                CPU Memory  : 5483.5 MB
                GPU MEMORY STATS: free/total = 16078.8/24091.8MB - allocated/peak allocated = 943.4/14489.5MB - reserved/peak reserved = 5766.0/21588.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: FAISS BUILD
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [FAISS SEARCH]

----------------------------------------------------------------------
                Message     : FAISS searched the candidates and resulted candidates_idxs with shape=(159591, 40)

                Event elapsed time: 207.32 seconds
                CPU Memory  : 5541.7 MB
                GPU MEMORY STATS: free/total = 256.8/24091.8MB - allocated/peak allocated = 943.4/14493.8MB - reserved/peak reserved = 21588.0/21588.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: FAISS SEARCH
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [Faiss recall] :: epoch= 6

----------------------------------------------------------------------
                Message     : faiss recall@40: 0.8010. faiss recall@5: 0.7760

----------------------------------------------------------------------
■ EVENT LOG END :: Faiss recall
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [Epoch summary] :: epoch= 6

----------------------------------------------------------------------
                Message     : Epoch average loss=0.121, average margin=0.3908, average mrr=0.7792, average accuracy@5=0.7993.   loss_temp=0.060

                Event elapsed time: 2552.23 seconds
                CPU Memory  : 5534.4 MB
                GPU MEMORY STATS: free/total = 194.8/24091.8MB - allocated/peak allocated = 943.6/14645.2MB - reserved/peak reserved = 21650.0/21650.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: Epoch summary
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [FAISS BUILD] :: epoch= 7

----------------------------------------------------------------------
                Message     : FAISS built from dictionary embs

                Event elapsed time: 787.44 seconds
                CPU Memory  : 5482.9 MB
                GPU MEMORY STATS: free/total = 16088.8/24091.8MB - allocated/peak allocated = 943.4/14489.5MB - reserved/peak reserved = 5766.0/21588.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: FAISS BUILD
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [checkpoint resotred]

----------------------------------------------------------------------
                Message     : Restoring checkpoint from file: ./output/encoder_12/checkpoints/last.pt

----------------------------------------------------------------------
■ EVENT LOG END :: checkpoint resotred
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [FAISS BUILD] :: epoch= 7

----------------------------------------------------------------------
                Message     : FAISS built from dictionary embs

                Event elapsed time: 732.14 seconds
                CPU Memory  : 4527.5 MB
                GPU MEMORY STATS: free/total = 20784.8/24091.8MB - allocated/peak allocated = 934.3/14494.4MB - reserved/peak reserved = 1080.0/20420.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: FAISS BUILD
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [FAISS SEARCH]

----------------------------------------------------------------------
                Message     : FAISS searched the candidates and resulted candidates_idxs with shape=(159591, 40)

                Event elapsed time: 329.92 seconds
                CPU Memory  : 4696.9 MB
                GPU MEMORY STATS: free/total = 1444.8/24091.8MB - allocated/peak allocated = 934.3/14498.9MB - reserved/peak reserved = 20420.0/20420.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: FAISS SEARCH
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [Faiss recall] :: epoch= 7

----------------------------------------------------------------------
                Message     : faiss recall@40: 0.8052. faiss recall@5: 0.7852

----------------------------------------------------------------------
■ EVENT LOG END :: Faiss recall
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [Epoch summary] :: epoch= 7

----------------------------------------------------------------------
                Message     : Epoch average loss=0.095, average margin=0.4091, average mrr=0.7822, average accuracy@5=0.7895.   loss_temp=0.060

                Event elapsed time: 3022.55 seconds
                CPU Memory  : 5390.9 MB
                GPU MEMORY STATS: free/total = 1358.8/24091.8MB - allocated/peak allocated = 1267.5/17568.9MB - reserved/peak reserved = 20496.0/20496.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: Epoch summary
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [FAISS BUILD] :: epoch= 8

----------------------------------------------------------------------
                Message     : FAISS built from dictionary embs

                Event elapsed time: 704.19 seconds
                CPU Memory  : 5428.9 MB
                GPU MEMORY STATS: free/total = 15478.8/24091.8MB - allocated/peak allocated = 1267.3/14829.3MB - reserved/peak reserved = 6358.0/20422.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: FAISS BUILD
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [FAISS SEARCH]

----------------------------------------------------------------------
                Message     : FAISS searched the candidates and resulted candidates_idxs with shape=(159591, 40)

                Event elapsed time: 248.37 seconds
                CPU Memory  : 5480.4 MB
                GPU MEMORY STATS: free/total = 1414.8/24091.8MB - allocated/peak allocated = 1267.3/14833.3MB - reserved/peak reserved = 20422.0/20422.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: FAISS SEARCH
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [Faiss recall] :: epoch= 8

----------------------------------------------------------------------
                Message     : faiss recall@40: 0.8116. faiss recall@5: 0.7950

----------------------------------------------------------------------
■ EVENT LOG END :: Faiss recall
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [Epoch summary] :: epoch= 8

----------------------------------------------------------------------
                Message     : Epoch average loss=0.068, average margin=0.4018, average mrr=0.7582, average accuracy@5=0.7599.   loss_temp=0.060

                Event elapsed time: 2582.27 seconds
                CPU Memory  : 5467.3 MB
                GPU MEMORY STATS: free/total = 1340.8/24091.8MB - allocated/peak allocated = 1267.5/17568.9MB - reserved/peak reserved = 20496.0/20496.0MB
----------------------------------------------------------------------
■ EVENT LOG END :: Epoch summary
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [Train finished]

----------------------------------------------------------------------
                Event elapsed time: 7645.74 seconds
----------------------------------------------------------------------
■ EVENT LOG END :: Train finished
======================================================================


======================================================================
▶ EVENT LOG :: [TRAIN] :: [Main info: ]

----------------------------------------------------------------------
                Message     : {'id': 12, 'start_time': '2025-12-01_14-08-53', 'train_started': True, 'finished': True, 'training_log_name': 'exp_6', 'log_details_file': './logs/log_12_2025-12-01_14-08-53.log', 'end_date': '2025-12-01_22-04-59', 'queries_size': 159591, 'dictionary_size': 4239386, 'trained_period': '2h, 7mins, 23secs', 'epochs': 8, 'last_faiss_recall@15': np.float64(0.8116247156794556), 'last_avg_acc_5': 0.7598684210526315, 'last_avg_mrr': 0.7582236842105263, 'last_avg_loss': 0.0675526095512218, 'result_encoder_dir': './output/encoder_12/'}

----------------------------------------------------------------------
■ EVENT LOG END :: Main info:
======================================================================


======================================================================
▶ EVENT LOG :: [eval] :: [Faiss recall@20]

----------------------------------------------------------------------
                Message     : 0.5653

----------------------------------------------------------------------
■ EVENT LOG END :: Faiss recall@20
======================================================================


======================================================================
▶ EVENT LOG :: [eval] :: [Faiss recall@5]

----------------------------------------------------------------------
                Message     : 0.5111

----------------------------------------------------------------------
■ EVENT LOG END :: Faiss recall@5
======================================================================


======================================================================
▶ EVENT LOG :: [eval] :: [Evaluation results]

----------------------------------------------------------------------
                Message     : Average Loss: 0.4192
  Mean Reciprocal Rank (MRR): 0.9141


----------------------------------------------------------------------
■ EVENT LOG END :: Evaluation results
======================================================================


======================================================================
▶ EVENT LOG :: [eval] :: [Evaluation  accuracy results]

----------------------------------------------------------------------
                Message     :      acc@1: 0.8704
     acc@2: 0.9225
     acc@4: 0.9626
     acc@5: 0.9738
     acc@7: 0.9867
    acc@10: 0.9946
    acc@12: 0.9960
    acc@15: 0.9994
    acc@17: 0.9996
    acc@20: 1.0000

----------------------------------------------------------------------
■ EVENT LOG END :: Evaluation  accuracy results
======================================================================


